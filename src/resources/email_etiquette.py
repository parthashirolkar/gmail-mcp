"""Professional email etiquette guidelines and best practices."""

EMAIL_ETIQUETTE_GUIDELINES = {
    "tone_and_language": {
        "title": "Professional Tone and Language",
        "guidelines": [
            {
                "principle": "Match the formality to your relationship and context",
                "explanation": "Use formal language for new contacts, executives, external clients",
                "examples": {
                    "formal": "Dear Mr. Johnson, I hope this email finds you well...",
                    "professional": "Hi Sarah, Hope you're doing well...",
                    "casual": "Hey team, Quick update on the project...",
                },
            },
            {
                "principle": "Use active voice and clear, direct language",
                "explanation": "Makes your writing more engaging and easier to understand",
                "examples": {
                    "passive": "The report will be completed by our team",
                    "active": "Our team will complete the report",
                },
            },
            {
                "principle": "Avoid jargon and acronyms with external contacts",
                "explanation": "Ensures your message is understood by all recipients",
                "tip": "Spell out acronyms on first use: 'Customer Relationship Management (CRM)'",
            },
            {
                "principle": "Use positive language when possible",
                "explanation": "Creates better relationships and more productive outcomes",
                "examples": {
                    "negative": "You failed to include the attachment",
                    "positive": "Could you please send the attachment when you have a moment?",
                },
            },
        ],
    },
    "timing_and_response": {
        "title": "Email Timing and Response Expectations",
        "guidelines": [
            {
                "principle": "Respond within 24-48 hours for business emails",
                "explanation": "Shows professionalism and respect for sender's time",
                "exceptions": "If you need more time, send a brief acknowledgment with timeline",
            },
            {
                "principle": "Consider recipient's time zone for urgent matters",
                "explanation": "Avoids creating unnecessary stress outside business hours",
                "tip": "Use scheduling features to send emails during recipient's business hours",
            },
            {
                "principle": "Use 'Reply All' thoughtfully",
                "explanation": "Only include recipients who need the information",
                "when_to_use": "When your response is relevant to all original recipients",
                "when_not_to_use": "Personal responses, thank you messages, 'I agree' replies",
            },
            {
                "principle": "Set expectations for response time",
                "explanation": "Helps manage urgency and workflow",
                "examples": [
                    "Please respond by EOD Friday",
                    "No rush on this - respond when convenient",
                    "Looking for feedback by next Tuesday's meeting",
                ],
            },
        ],
    },
    "structure_and_formatting": {
        "title": "Email Structure and Formatting",
        "guidelines": [
            {
                "principle": "Use descriptive subject lines",
                "explanation": "Helps recipients prioritize and find emails later",
                "format": "Action/Topic: Specific details - Context",
                "examples": [
                    "Meeting Request: Q4 Budget Review - Next Friday",
                    "Action Required: Approve contract by Monday",
                ],
            },
            {
                "principle": "Start with appropriate greeting",
                "explanation": "Sets professional tone and shows respect",
                "options": {
                    "formal": "Dear Ms. Smith,",
                    "professional": "Hello John,",
                    "team_email": "Hi everyone,",
                    "follow_up": "Hi again,",
                },
            },
            {
                "principle": "Use bullet points for multiple items",
                "explanation": "Improves readability and comprehension",
                "when_to_use": "Lists of tasks, multiple questions, agenda items",
            },
            {
                "principle": "Include clear call-to-action",
                "explanation": "Ensures recipient knows what's expected",
                "examples": [
                    "Please confirm your attendance by Thursday",
                    "I'd appreciate your feedback on the proposal",
                    "Let me know if you have any questions",
                ],
            },
        ],
    },
    "professional_courtesy": {
        "title": "Professional Courtesy and Respect",
        "guidelines": [
            {
                "principle": "Acknowledge receipt of important emails",
                "explanation": "Confirms communication was received and prevents follow-ups",
                "when_needed": "Urgent requests, detailed instructions, formal documents",
            },
            {
                "principle": "Be mindful of email frequency",
                "explanation": "Avoid overwhelming recipients with too many emails",
                "tip": "Combine related topics into one email when appropriate",
            },
            {
                "principle": "Use proper names and titles",
                "explanation": "Shows respect and attention to detail",
                "check": "Verify spelling of names and appropriate titles (Dr., Prof., etc.)",
            },
            {
                "principle": "Thank people for their time and effort",
                "explanation": "Builds positive relationships and encourages continued cooperation",
                "examples": [
                    "Thank you for taking the time to review this",
                    "I appreciate your prompt response",
                    "Thanks for your hard work on this project",
                ],
            },
        ],
    },
    "cultural_considerations": {
        "title": "Cultural Sensitivity and Global Communication",
        "guidelines": [
            {
                "principle": "Be aware of different communication styles",
                "explanation": "Some cultures prefer more formal, indirect communication",
                "adaptation": "Adjust your tone based on cultural background of recipients",
            },
            {
                "principle": "Consider time zones for global teams",
                "explanation": "Shows respect for work-life balance across regions",
                "practices": [
                    "Mention time zones when scheduling: '3 PM EST / 8 PM GMT'",
                    "Use scheduling tools that show multiple time zones",
                    "Avoid marking emails as urgent for non-emergency cross-timezone communications",
                ],
            },
            {
                "principle": "Use clear, simple language for non-native speakers",
                "explanation": "Improves understanding and inclusion",
                "practices": [
                    "Avoid idioms and cultural references",
                    "Use shorter sentences",
                    "Define technical terms when necessary",
                ],
            },
            {
                "principle": "Be patient with response times across cultures",
                "explanation": "Different cultures have different expectations for response speed",
                "consideration": "Some cultures prioritize face-to-face discussion before email response",
            },
        ],
    },
    "meeting_email_etiquette": {
        "title": "Meeting-Related Email Etiquette",
        "guidelines": [
            {
                "principle": "Send meeting invitations with sufficient notice",
                "explanation": "Allows participants to plan and prepare appropriately",
                "timing": "At least 24-48 hours for routine meetings, 1 week+ for important meetings",
            },
            {
                "principle": "Include all essential meeting information",
                "explanation": "Reduces confusion and follow-up questions",
                "include": [
                    "Date, time, and duration",
                    "Location or video link",
                    "Agenda or purpose",
                    "Required preparation",
                    "List of attendees",
                ],
            },
            {
                "principle": "Send meeting minutes or follow-ups promptly",
                "explanation": "Ensures accountability and action item tracking",
                "timing": "Within 24 hours of the meeting",
            },
            {
                "principle": "Confirm important meetings in advance",
                "explanation": "Reduces no-shows and scheduling conflicts",
                "when": "Day before important meetings or with external participants",
            },
        ],
    },
}

EMAIL_TONE_GUIDE = {
    "formal": {
        "when_to_use": "External clients, executives, legal/compliance matters, first contact",
        "characteristics": [
            "Complete sentences and proper grammar",
            "Formal greetings: 'Dear Mr./Ms. [Last Name]'",
            "Professional closings: 'Sincerely,' 'Best regards,'",
            "No contractions: 'do not' instead of 'don't'",
            "Third person when appropriate",
        ],
        "example": """
Dear Ms. Johnson,

I hope this message finds you well. I am writing to follow up on our discussion regarding the quarterly budget review meeting.

Would you be available to meet on Friday, March 15th, at 2:00 PM? The meeting should take approximately one hour, and we will be discussing the Q1 budget allocations and planning for Q2.

Please let me know if this time works for your schedule, or if you would prefer an alternative time.

Thank you for your time and consideration.

Sincerely,
[Your Name]
        """,
    },
    "professional": {
        "when_to_use": "Colleagues, internal communications, established business relationships",
        "characteristics": [
            "Friendly but business-focused",
            "Casual greetings: 'Hi [First Name],' 'Hello [Name],'",
            "Professional but warm closings: 'Best,' 'Thanks,' 'Best regards,'",
            "Contractions are acceptable",
            "Direct and clear communication",
        ],
        "example": """
Hi Sarah,

Hope you're doing well! I wanted to touch base about the project timeline we discussed last week.

I've reviewed the current status and think we can move the deadline up by a few days if needed. Here's what I'm thinking:

• Phase 1: Complete by March 10th (originally March 12th)  
• Phase 2: Start March 11th instead of March 13th
• Final delivery: March 20th (no change)

Let me know your thoughts when you get a chance.

Best,
[Your Name]
        """,
    },
    "casual": {
        "when_to_use": "Close team members, informal internal updates, brainstorming sessions",
        "characteristics": [
            "Relaxed and conversational",
            "Informal greetings: 'Hey [Name],' 'Hi team,'",
            "Casual closings: 'Thanks!' 'Cheers,' or just your name",
            "Shorter sentences and paragraphs",
            "Some humor appropriate if it fits the culture",
        ],
        "example": """
Hey team,

Quick update on the website redesign:

✅ New homepage is live  
🔄 Working on the contact page  
📅 Should have everything done by Friday

Any issues or feedback, just let me know!

Thanks,
[Your Name]
        """,
    },
}

COMMON_ETIQUETTE_MISTAKES = [
    {
        "mistake": "Writing emails when emotional or frustrated",
        "consequence": "Can damage relationships and professional reputation",
        "solution": "Write the email, save as draft, review later with clear head",
    },
    {
        "mistake": "Using Reply All unnecessarily",
        "consequence": "Clutters inboxes and can annoy recipients",
        "solution": "Consider if all recipients need your response; use Reply instead",
    },
    {
        "mistake": "Forgetting to include context in follow-up emails",
        "consequence": "Recipients may not remember the original conversation",
        "solution": "Include brief context: 'Following up on our discussion about...'",
    },
    {
        "mistake": "Using vague subject lines",
        "consequence": "Emails get overlooked or lost in busy inboxes",
        "solution": "Be specific: 'Budget meeting' becomes 'Budget meeting: March 15 at 2 PM'",
    },
    {
        "mistake": "Not proofreading before sending",
        "consequence": "Typos and errors can appear unprofessional",
        "solution": "Always review emails for spelling, grammar, and clarity",
    },
    {
        "mistake": "Overusing urgent/high priority flags",
        "consequence": "Recipients learn to ignore them, reducing effectiveness",
        "solution": "Reserve for truly urgent matters; use sparingly",
    },
]


def get_tone_guide(tone_type: str = "professional") -> dict:
    """Get email tone guidelines for specific communication style.

    Args:
        tone_type: Type of tone (formal, professional, casual)

    Returns:
        Dictionary with tone guidelines and example
    """
    return EMAIL_TONE_GUIDE.get(tone_type, EMAIL_TONE_GUIDE["professional"])


def assess_email_tone(
    email_content: str, recipient_relationship: str = "professional"
) -> dict:
    """Assess if email tone matches the intended recipient relationship.

    Args:
        email_content: Email body content
        recipient_relationship: Relationship type (formal, professional, casual)

    Returns:
        Dictionary with tone assessment and suggestions
    """
    # Simple analysis - in practice this could be much more sophisticated
    formal_indicators = ["dear", "sincerely", "regards", "please find attached"]
    casual_indicators = ["hey", "hi there", "thanks!", "cheers", "btw"]

    formal_count = sum(
        1 for indicator in formal_indicators if indicator in email_content.lower()
    )
    casual_count = sum(
        1 for indicator in casual_indicators if indicator in email_content.lower()
    )

    detected_tone = (
        "formal"
        if formal_count > casual_count
        else "casual"
        if casual_count > 0
        else "professional"
    )

    appropriate = (
        (
            recipient_relationship == "formal"
            and detected_tone in ["formal", "professional"]
        )
        or (
            recipient_relationship == "professional"
            and detected_tone in ["professional", "formal"]
        )
        or (
            recipient_relationship == "casual"
            and detected_tone in ["casual", "professional"]
        )
    )

    recommendations = []
    if not appropriate:
        if recipient_relationship == "formal" and detected_tone == "casual":
            recommendations.append(
                "Consider using more formal language for this recipient"
            )
        elif recipient_relationship == "casual" and detected_tone == "formal":
            recommendations.append(
                "You can use more relaxed language with this recipient"
            )

    return {
        "detected_tone": detected_tone,
        "appropriate_for_recipient": appropriate,
        "recommendations": recommendations,
        "suggested_tone": get_tone_guide(recipient_relationship),
    }
